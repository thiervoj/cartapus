(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const e of r)if(e.type==="childList")for(const t of e.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&a(t)}).observe(document,{childList:!0,subtree:!0});function n(r){const e={};return r.integrity&&(e.integrity=r.integrity),r.referrerpolicy&&(e.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?e.credentials="include":r.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(r){if(r.ep)return;r.ep=!0;const e=n(r);fetch(r.href,e)}})();function p(o,s){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},p(o,s)}function b(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function m(o,s){(s==null||s>o.length)&&(s=o.length);for(var n=0,a=new Array(s);n<s;n++)a[n]=o[n];return a}function l(o,s){var n=typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(n)return(n=n.call(o)).next.bind(n);if(Array.isArray(o)||(n=function(r,e){if(r){if(typeof r=="string")return m(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?m(r,e):void 0}}(o))||s&&o&&typeof o.length=="number"){n&&(o=n);var a=0;return function(){return a>=o.length?{done:!0}:{done:!1,value:o[a++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f(){}f.prototype={on:function(o,s,n){var a=this.e||(this.e={});return(a[o]||(a[o]=[])).push({fn:s,ctx:n}),this},once:function(o,s,n){var a=this;function r(){a.off(o,r),s.apply(n,arguments)}return r._=s,this.on(o,r,n)},emit:function(o){for(var s=[].slice.call(arguments,1),n=((this.e||(this.e={}))[o]||[]).slice(),a=0,r=n.length;a<r;a++)n[a].fn.apply(n[a].ctx,s);return this},off:function(o,s){var n=this.e||(this.e={}),a=n[o],r=[];if(a&&s)for(var e=0,t=a.length;e<t;e++)a[e].fn!==s&&a[e].fn._!==s&&r.push(a[e]);return r.length?n[o]=r:delete n[o],this}};var g=f;g.TinyEmitter=f;var A=function(o){var s,n;function a(e){var t;return e===void 0&&(e={}),(t=o.call(this)||this).intersect=t.intersect.bind(b(t)),t.mutate=t.mutate.bind(b(t)),t.options=Object.assign({root:null,rootMargin:"0px",threshold:0,once:!1},e),t.observers=[t.createObserver()],t.createObservers(),t.createMutationObserver(),t.observe(),t}n=o,(s=a).prototype=Object.create(n.prototype),s.prototype.constructor=s,p(s,n);var r=a.prototype;return r.createObservers=function(){for(var e,t=l((this.options.root?this.options.root:document).querySelectorAll("[data-cartapus]"));!(e=t()).done;)this.storeNewElement(e.value)},r.findObserverForElement=function(e){var t=e.dataset.cartapusThreshold?parseFloat(e.dataset.cartapusThreshold):this.options.threshold,i=e.dataset.cartapusRootMargin?e.dataset.cartapusRootMargin:this.options.rootMargin;return this.observers.find(function(c){return c.threshold===t&&c.rootMargin===i})},r.storeNewElement=function(e){if(!e.hasAttribute("data-cartapus"))return!1;if(e.dataset.cartapusThreshold||e.dataset.cartapusRootMargin){var t=this.findObserverForElement(e);if(t)t.elements.push(e),e._cartapus=t;else{var i=e.dataset.cartapusThreshold?parseFloat(e.dataset.cartapusThreshold):this.options.threshold;this.observers.push(this.createObserver({element:e,options:{threshold:i,rootMargin:e.dataset.cartapusRootMargin?e.dataset.cartapusRootMargin:this.options.rootMargin}}))}}else this.observers[0].elements.push(e),e._cartapus=this.observers[0];return!0},r.createObserver=function(e){var t=e===void 0?{}:e,i=t.element,c=Object.assign(this.options,t.options),u={observer:new IntersectionObserver(this.intersect,c),threshold:c.threshold,rootMargin:c.rootMargin,elements:i?[i]:[]};return i&&(i._cartapus=u),u},r.createMutationObserver=function(){this.mutationObserver=new MutationObserver(this.mutate),this.mutationObserver.observe(this.options.root?this.options.root:document.body,{childList:!0,subtree:!0})},r.intersect=function(e,t){for(var i,c=l(e);!(i=c()).done;){var u=i.value;u.isIntersecting?(u.target.setAttribute("data-cartapus","visible"),u.target.hasAttribute("data-cartapus-once")&&t.unobserve(u.target)):u.target.setAttribute("data-cartapus","hidden"),this.dispatch(u)}},r.dispatch=function(e){var t={element:e.target,visible:e.isIntersecting,intersection:e},i=new CustomEvent("cartapusintersect",{detail:t});e.target.dispatchEvent(i),this.emit("intersect",t)},r.mutate=function(e){for(var t,i=l(e);!(t=i()).done;){var c=t.value;if(c.type==="childList"){for(var u,y=l(c.addedNodes);!(u=y()).done;){var h=u.value;this.storeNewElement(h)&&h._cartapus.observer.observe(h)}for(var v,O=l(c.removedNodes);!(v=O()).done;){var d=v.value;if(d._cartapus){var M=d._cartapus.elements.indexOf(d);d._cartapus.elements.splice(M,1),d._cartapus.observer.unobserve(d)}}}}},r.observe=function(){for(var e,t=l(this.observers);!(e=t()).done;)for(var i,c=e.value,u=l(c.elements);!(i=u()).done;)c.observer.observe(i.value)},r.unobserve=function(){for(var e,t=l(this.observers);!(e=t()).done;)for(var i,c=e.value,u=l(c.elements);!(i=u()).done;)c.observer.unobserve(i.value)},r.destroy=function(){this.unobserve(),this.mutationObserver.disconnect();for(var e,t=l(this.observers);!(e=t()).done;){for(var i,c=e.value,u=l(c.elements);!(i=u()).done;)delete i.value._cartapus;c.observer.disconnect(),c.elements=[]}},a}(g);new A;const E=document.querySelector(".wrapper");console.log("Ready");setTimeout(()=>{const o=document.createElement("div"),s=document.createElement("p");o.classList.add("card"),o.setAttribute("data-cartapus",""),s.textContent="Am I visible ?",console.log("---------"),console.log("APPEND"),o.appendChild(s),E.appendChild(o)},6e3);setTimeout(()=>{const o=document.querySelectorAll(".card");console.log("---------"),console.log("REMOVE"),o[o.length-1].remove()},1e4);
